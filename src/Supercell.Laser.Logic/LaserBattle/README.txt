половина всей логики была высосана с вело... да и похуй, главное работает